<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consulta Check - Auditoria M√©dica AI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4F46E5; /* Indigo 600 */
            --primary-hover: #4338ca;
            --secondary: #64748b; /* Slate 500 */
            --success: #10b981; /* Emerald 500 */
            --success-bg: #ecfdf5;
            --error: #ef4444; /* Red 500 */
            --error-bg: #fef2f2;
            --surface: #ffffff;
            --background: #f1f5f9; /* Slate 100 */
            --text-main: #1e293b;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --radius: 12px;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--background);
            color: var(--text-main);
            line-height: 1.5;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 850px;
            margin: 0 auto;
        }

        /* HEADER */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .brand-icon {
            font-size: 1.8rem;
            background: white;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            box-shadow: var(--shadow);
            color: var(--primary);
        }
        .brand-text h1 {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-main);
        }
        .brand-text span {
            font-size: 0.85rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* CARDS */
        .card {
            background: var(--surface);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 24px;
            border: 1px solid var(--border);
            transition: transform 0.2s ease;
        }

        /* BUTTONS */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover:not(:disabled) { background: var(--primary-hover); transform: translateY(-1px); }
        .btn-secondary { background: white; border: 1px solid var(--border); color: var(--text-main); }
        .btn-secondary:hover { background: #f8fafc; border-color: #cbd5e1; }
        .btn-danger { background: var(--error); color: white; }
        .btn-ghost { background: transparent; color: var(--text-muted); padding: 8px; }
        .btn-ghost:hover { color: var(--text-main); background: #f1f5f9; }
        
        button:disabled { opacity: 0.6; cursor: not-allowed; transform: none !important; }

        /* FORMS */
        .input-group { margin-bottom: 20px; }
        label { display: block; font-weight: 600; margin-bottom: 8px; color: var(--text-main); font-size: 0.9rem; }
        input[type="text"], input[type="password"] {
            width: 100%; padding: 12px; border: 1px solid var(--border); border-radius: 8px;
            font-family: inherit; font-size: 1rem; transition: border-color 0.2s;
        }
        input:focus { outline: none; border-color: var(--primary); box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1); }

        /* UPLOAD & RECORD AREA */
        .media-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 10px;
        }
        .upload-zone {
            border: 2px dashed var(--border);
            border-radius: var(--radius);
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }
        .upload-zone:hover { border-color: var(--primary); background: #f5f3ff; }
        .upload-zone input { 
            position: absolute; top:0; left:0; width:100%; height:100%; opacity:0; cursor:pointer; 
        }
        
        .record-zone {
            background: #f8fafc;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        .mic-btn {
            width: 60px; height: 60px;
            border-radius: 50%;
            border: none;
            background: var(--primary);
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            box-shadow: 0 4px 10px rgba(79, 70, 229, 0.3);
            transition: transform 0.2s;
        }
        .mic-btn:hover { transform: scale(1.05); }
        .mic-btn.recording { 
            background: var(--error); 
            animation: pulse-ring 2s infinite;
        }

        /* STATUS */
        .status-bar {
            background: var(--text-main);
            color: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            margin: 20px 0;
            font-weight: 500;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .loader {
            width: 18px; height: 18px; border: 2px solid #fff; border-bottom-color: transparent; border-radius: 50%;
            display: inline-block; animation: rotation 1s linear infinite;
        }

        /* TABS */
        .tabs { 
            display: flex; gap: 20px; border-bottom: 1px solid var(--border); margin-bottom: 25px; 
        }
        .tab-btn {
            background: none; border: none; padding: 10px 0;
            font-size: 1rem; font-weight: 500; color: var(--text-muted);
            cursor: pointer; position: relative;
        }
        .tab-btn.active { color: var(--primary); font-weight: 600; }
        .tab-btn.active::after {
            content: ''; position: absolute; bottom: -1px; left: 0; width: 100%; height: 2px; background: var(--primary);
        }

        /* CHECKLIST RESULTS */
        .checklist-section h4 {
            color: var(--text-muted);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 30px 0 15px 0;
            border-bottom: 1px solid var(--border);
            padding-bottom: 5px;
        }
        .checklist-section:first-child h4 { margin-top: 0; }
        
        .checklist-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 12px;
            background: white;
            border: 1px solid transparent;
        }
        
        /* Pass State */
        .checklist-pass {
            background-color: var(--success-bg);
            border-color: rgba(16, 185, 129, 0.2);
        }
        .checklist-pass .checklist-icon { color: var(--success); }
        .checklist-pass .checklist-title { color: #065f46; }

        /* Fail State */
        .checklist-fail {
            background-color: var(--error-bg);
            border-color: rgba(239, 68, 68, 0.2);
        }
        .checklist-fail .checklist-icon { color: var(--error); }
        .checklist-fail .checklist-title { color: #991b1b; }

        .checklist-icon { font-size: 1.2rem; flex-shrink: 0; margin-top: 2px; }
        .checklist-content { flex: 1; }
        .checklist-title { font-weight: 600; font-size: 0.95rem; margin-bottom: 4px; display: block; }
        .checklist-comment { font-size: 0.9rem; color: var(--text-muted); line-height: 1.4; }

        /* UTILS */
        .hidden { display: none !important; }
        pre { background: #1e293b; color: #e2e8f0; padding: 20px; border-radius: 8px; overflow-x: auto; font-family: 'Inter', monospace; font-size: 0.9rem; }
        
        @keyframes pulse-ring { 0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.4); } 70% { box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); } 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); } }
        @keyframes rotation { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Responsive */
        @media (max-width: 600px) {
            .media-controls { grid-template-columns: 1fr; }
            .checklist-item { flex-direction: column; gap: 8px; }
        }
    </style>
</head>
<body>

    <div class="container">
        <!-- HEADER -->
        <header>
            <div class="brand">
                <div class="brand-icon">ü©∫</div>
                <div class="brand-text">
                    <h1>Consulta Check</h1>
                    <span>Auditoria Calgary-Cambridge AI</span>
                </div>
            </div>
            <button onclick="resetApp()" class="btn btn-ghost" title="Configura√ß√µes">
                ‚öôÔ∏è Ajustes
            </button>
        </header>

        <!-- CONFIG CARD -->
        <div id="configSection" class="card hidden">
            <h2 style="margin-bottom: 15px;">üîê Configura√ß√£o Inicial</h2>
            <p style="color: var(--text-muted); margin-bottom: 20px;">Para realizar a auditoria, precisamos da sua chave de API do Google Gemini.</p>
            
            <div class="input-group">
                <label>API Key (Google AI Studio)</label>
                <input type="password" id="apiKeyInput" placeholder="Cole sua chave aqui (AIza...)">
            </div>
            
            <div class="input-group">
                <label>ID do Modelo</label>
                <input type="text" id="modelIdInput" value="gemini-2.5-flash" placeholder="ex: gemini-2.5-flash">
            </div>
            
            <button onclick="saveConfig()" class="btn btn-primary" style="width: 100%;">Salvar e Acessar</button>
        </div>

        <!-- MAIN APP -->
        <div id="mainSection" class="hidden">
            
            <!-- INPUT CARD -->
            <div class="card">
                <h2 style="margin-bottom: 5px;">Nova An√°lise</h2>
                <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 20px;">Envie o √°udio da consulta ou grave agora mesmo.</p>
                
                <div class="media-controls">
                    <!-- Upload -->
                    <div class="upload-zone" id="uploadZone">
                        <div style="font-size: 2rem; margin-bottom: 10px;">üìÅ</div>
                        <input type="file" id="audioFileInput" accept="audio/*,video/*" onchange="handleFileSelect()">
                        <strong id="fileNameDisplay" style="display:block; color: var(--primary);">Clique ou arraste o arquivo</strong>
                        <span style="font-size: 0.8rem; color: var(--text-muted);">MP3, WAV, M4A...</span>
                    </div>

                    <!-- Record -->
                    <div class="record-zone" id="recordZone">
                        <button id="micBtn" class="mic-btn" onclick="toggleRecording()">üéôÔ∏è</button>
                        <span id="micStatus" style="font-weight: 500; font-size: 0.9rem;">Gravar Consulta</span>
                    </div>
                </div>

                <div id="status" class="status-bar hidden"></div>

                <button id="btnProcessar" onclick="processAnalysis()" class="btn btn-primary" style="width: 100%; margin-top: 20px; padding: 15px; font-size: 1.1rem;" disabled>
                    ‚ú® Iniciar Auditoria IA
                </button>
            </div>

            <!-- RESULTS CARD -->
            <div id="resultsArea" class="card hidden">
                <div class="tabs">
                    <button onclick="showTab('tab-analysis')" class="tab-btn active" id="btn-tab-analysis">üìä Relat√≥rio de Performance</button>
                    <button onclick="showTab('tab-transcript')" class="tab-btn" id="btn-tab-transcript">üí¨ Transcri√ß√£o Completa</button>
                </div>

                <!-- Analysis Content -->
                <div id="tab-analysis">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                        <h3 style="font-size:1.1rem;">Checklist de Qualidade</h3>
                        <button onclick="copyToClipboard('outputAnalysis')" class="btn btn-secondary btn-sm" style="font-size:0.8rem; padding: 6px 12px;">Copiar</button>
                    </div>
                    <div id="outputAnalysis">
                        <!-- Content will be injected here -->
                    </div>
                </div>

                <!-- Transcript Content -->
                <div id="tab-transcript" class="hidden">
                     <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
                        <h3 style="font-size:1.1rem;">Texto Verbatim</h3>
                        <button onclick="copyToClipboard('outputTranscript')" class="btn btn-secondary btn-sm" style="font-size:0.8rem; padding: 6px 12px;">Copiar</button>
                    </div>
                    <pre id="outputTranscript">Aguardando processamento...</pre>
                </div>
            </div>

        </div>
    </div>

    <script type="module">
        import { GoogleGenerativeAI } from "https://esm.run/@google/generative-ai";

        let mediaRecorder;
        let audioChunks = [];
        let activeAudioBlob = null;
        let genAI;
        let isRecording = false;

        // --- AUTH & INIT ---
        window.checkAuth = function() {
            const key = localStorage.getItem("gemini_api_key");
            const modelId = localStorage.getItem("gemini_model_id") || "gemini-2.5-flash";

            if (key) {
                document.getElementById('configSection').classList.add('hidden');
                document.getElementById('mainSection').classList.remove('hidden');
                // Fill inputs for editing later
                document.getElementById('apiKeyInput').value = key;
                document.getElementById('modelIdInput').value = modelId;
                genAI = new GoogleGenerativeAI(key);
            } else {
                document.getElementById('configSection').classList.remove('hidden');
                document.getElementById('mainSection').classList.add('hidden');
            }
        }

        window.saveConfig = function() {
            const key = document.getElementById('apiKeyInput').value.trim();
            const modelId = document.getElementById('modelIdInput').value.trim();
            if (key.length > 10) {
                localStorage.setItem("gemini_api_key", key);
                localStorage.setItem("gemini_model_id", modelId);
                checkAuth();
            } else { alert("Por favor, insira uma chave de API v√°lida."); } 
        }

        window.resetApp = function() {
            document.getElementById('mainSection').classList.add('hidden');
            document.getElementById('configSection').classList.remove('hidden');
        }

        // --- TABS ---
        window.showTab = function(tabId) {
            ['tab-analysis', 'tab-transcript'].forEach(id => document.getElementById(id).classList.add('hidden'));
            ['btn-tab-analysis', 'btn-tab-transcript'].forEach(id => document.getElementById(id).classList.remove('active'));
            document.getElementById(tabId).classList.remove('hidden');
            document.getElementById('btn-' + tabId).classList.add('active');
        }

        // --- FILE HANDLING ---
        window.handleFileSelect = function() {
            const fileInput = document.getElementById('audioFileInput');
            if(fileInput.files && fileInput.files[0]) {
                activeAudioBlob = fileInput.files[0]; 
                document.getElementById('fileNameDisplay').innerText = activeAudioBlob.name;
                document.getElementById('uploadZone').style.borderColor = "var(--primary)";
                document.getElementById('uploadZone').style.background = "#eef2ff";
                enableProcessButton();
            }
        }

        function enableProcessButton() {
            const btn = document.getElementById('btnProcessar');
            btn.disabled = false;
            btn.innerText = "‚ú® Iniciar Auditoria IA";
        }

        // --- RECORDING ---
        window.toggleRecording = async function() {
            if (!isRecording) {
                await startRecording();
            } else {
                stopRecording();
            }
        }

        async function startRecording() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                mediaRecorder = new MediaRecorder(stream);
                audioChunks = [];
                mediaRecorder.ondataavailable = event => audioChunks.push(event.data);
                
                mediaRecorder.onstop = () => {
                    activeAudioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                    document.getElementById('micStatus').innerText = "Grava√ß√£o Finalizada";
                    document.getElementById('micBtn').classList.remove('recording');
                    document.getElementById('micBtn').innerHTML = "üéôÔ∏è";
                    isRecording = false;
                    enableProcessButton();
                };

                mediaRecorder.start();
                isRecording = true;
                document.getElementById('micBtn').classList.add('recording');
                document.getElementById('micBtn').innerHTML = "‚¨õ"; // Stop icon
                document.getElementById('micStatus').innerText = "Gravando... (Clique para parar)";
                
                // Reset file input visual
                document.getElementById('fileNameDisplay').innerText = "Clique ou arraste o arquivo";
                document.getElementById('uploadZone').style.borderColor = "var(--border)";
                document.getElementById('uploadZone').style.background = "transparent";

            } catch (err) { alert("Erro ao acessar microfone: " + err); }
        }

        function stopRecording() {
            if(mediaRecorder) mediaRecorder.stop();
        }

        // --- API HELPERS ---
        async function fileToGenerativePart(file) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onloadend = () => resolve({
                    inlineData: { data: reader.result.split(',')[1], mimeType: file.type || "audio/mp3" }
                });
                reader.readAsDataURL(file);
            });
        }

        window.copyToClipboard = function(elementId) {
            const text = document.getElementById(elementId).innerText;
            navigator.clipboard.writeText(text).then(() => {
                const btn = event.target;
                const originalText = btn.innerText;
                btn.innerText = "Copiado!";
                setTimeout(() => btn.innerText = originalText, 2000);
            });
        }

        // --- MAIN LOGIC (Refactored UI, Same Core) ---
        window.processAnalysis = async function() {
            if (!activeAudioBlob) return alert("Nenhum √°udio selecionado!");
            
            const btn = document.getElementById('btnProcessar');
            const status = document.getElementById('status');
            const resultsArea = document.getElementById('resultsArea');
            const currentModelId = localStorage.getItem("gemini_model_id") || "gemini-2.5-flash";

            // UI State: Loading
            btn.disabled = true;
            status.classList.remove('hidden');
            status.innerHTML = '<span class="loader"></span> Inicializando IA...';
            resultsArea.classList.add('hidden'); // Hide previous results while loading new ones
            
            // Clear previous content
            document.getElementById('outputTranscript').innerText = "";
            document.getElementById('outputAnalysis').innerHTML = "";

            try {
                const model = genAI.getGenerativeModel({ model: currentModelId });
                const audioPart = await fileToGenerativePart(activeAudioBlob);

                // STEP 1: TRANSCRIPTION
                status.innerHTML = '<span class="loader"></span> Etapa 1/2: Ouvindo e transcrevendo...';
                
                const transcriptPrompt = `
                Transcreva o √°udio da consulta m√©dica a seguir palavra por palavra (verbatim).
                Identifique claramente os falantes como 'M√©dico:' e 'Paciente:' (ou 'Acompanhante:').
                Mantenha termos t√©cnicos se usados, mas tamb√©m as express√µes coloquiais do paciente.
                N√£o resuma.
                `;

                const resultTranscript = await model.generateContent([transcriptPrompt, audioPart]);
                const transcriptText = (await resultTranscript.response).text();
                
                document.getElementById('outputTranscript').innerText = transcriptText;

                // STEP 2: ANALYSIS
                status.innerHTML = '<span class="loader"></span> Etapa 2/2: O Supervisor est√° avaliando...';

                const analysisPrompt = `
                ATUE COMO UM SUPERVISOR DE COMUNICA√á√ÉO M√âDICA S√äNIOR E RIGOROSO.
                
                Objetivo: Avaliar a consulta transcrita abaixo usando o "Guia Calgary-Cambridge".
                
                --- TRANSCRI√á√ÉO DA CONSULTA ---
                ${transcriptText}
                --- FIM DA TRANSCRI√á√ÉO ---

                TAREFA:
                Gere um relat√≥rio estruturado avaliando cada ponto.
                
                REGRA CRUCIAL DE FORMATA√á√ÉO:
                Para CADA item, voc√™ DEVE iniciar a linha com:
                "- [S]" se o crit√©rio foi SATISFAT√ìRIO/CUMPRIDO.
                "- [N]" se o crit√©rio foi N√ÉO CUMPRIDO, ESQUECIDO ou INSATISFAT√ìRIO.
                
                N√ÉO use [x] ou [ ]. Use APENAS [S] ou [N].
                
                ESTRUTURA OBRIGAT√ìRIA DA RESPOSTA:

                ### 1. INICIANDO A SESS√ÉO
                - [S] ou [N] **Prepara√ß√£o:** Se apresentou e confirmou identidade?
                  > *Evid√™ncia:* ...
                - [S] ou [N] **Rapport Inicial:** Demonstrou respeito inicial?
                  > *Evid√™ncia:* ...

                ### 2. IDENTIFICANDO O MOTIVO DA CONSULTA
                - [S] ou [N] **Pergunta Aberta:** Iniciou com "O que o traz aqui?" ou similar?
                  > *Evid√™ncia:* ...
                - [S] ou [N] **Escuta Ativa:** Ouviu sem interromper?
                  > *Evid√™ncia:* ...
                - [S] ou [N] **Agenda Oculta:** Perguntou "Algo mais?" para descobrir outras queixas?
                  > *Evid√™ncia:* ...

                ### 3. REUNINDO INFORMA√á√ïES
                - [S] ou [N] **Hist√≥ria do Paciente:** Encorajou a fala livre?
                  > *Evid√™ncia:* ...
                - [S] ou [N] **Funil de Perguntas:** Aberta -> Fechada?
                  > *Evid√™ncia:* ...
                - [S] ou [N] **Perspectiva do Paciente (F.I.F.E):** Explorou Sentimentos, Ideias, Funcionalidade ou Expectativas?
                  > *Evid√™ncia:* ...

                ### 4. ESTRUTURA√á√ÉO
                - [S] ou [N] **Sinaliza√ß√£o:** Usou frases de transi√ß√£o?
                  > *Evid√™ncia:* ...
                - [S] ou [N] **Organiza√ß√£o:** Sequ√™ncia l√≥gica?
                  > *Evid√™ncia:* ...

                ### 5. CONSTRUINDO RELACIONAMENTO
                - [S] ou [N] **Empatia:** Validou sentimentos?
                  > *Evid√™ncia:* ...
                - [S] ou [N] **N√£o-verbal (Inferido):** Tom acolhedor?
                  > *Evid√™ncia:* ...

                ### 6. EXPLICA√á√ÉO E PLANEJAMENTO
                - [S] ou [N] **Linguagem:** Evitou jarg√µes?
                  > *Evid√™ncia:* ...
                - [S] ou [N] **Chunk and Check:** Informa√ß√£o em blocos?
                  > *Evid√™ncia:* ...
                - [S] ou [N] **Teach-back:** Pediu para o paciente repetir/explicar?
                  > *Evid√™ncia:* ...
                - [S] ou [N] **Decis√£o Compartilhada:** Envolveu na decis√£o?
                  > *Evid√™ncia:* ...

                ### 7. FECHAMENTO
                - [S] ou [N] **Resumo:** Resumiu o plano?
                  > *Evid√™ncia:* ...
                - [S] ou [N] **Safety Netting:** Explicou sinais de alerta?
                  > *Evid√™ncia:* ...

                ### 8. CONCLUS√ÉO FINAL
                (Breve resumo qualitativo).
                `;

                const resultAnalysis = await model.generateContent(analysisPrompt);
                const analysisText = (await resultAnalysis.response).text();

                // --- PARSER ---
                let html = analysisText;
                html = html.replace(/^### (.*$)/gim, '<div class="checklist-section"><h4>$1</h4>');
                html = html.replace(/- \[S\] \*\*(.*?)\*\*(.*?)(\n|$)/gim, 
                    '<div class="checklist-item checklist-pass"><div class="checklist-icon">‚úì</div><div class="checklist-content"><span class="checklist-title">$1</span>');
                html = html.replace(/- \[N\] \*\*(.*?)\*\*(.*?)(\n|$)/gim, 
                    '<div class="checklist-item checklist-fail"><div class="checklist-icon">‚úó</div><div class="checklist-content"><span class="checklist-title">$1</span>');
                html = html.replace(/> \*(.*?)\* (.*?)(\n|$)/gim, 
                    '<div class="checklist-comment">$1 $2</div></div></div>'); 
                html = html.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>');
                
                document.getElementById('outputAnalysis').innerHTML = html;

                // Done
                status.classList.add('hidden');
                resultsArea.classList.remove('hidden');
                btn.disabled = false;
                btn.innerText = "‚ú® Iniciar Auditoria IA";

            } catch (error) {
                console.error(error);
                status.innerHTML = "‚ùå Erro: " + error.message;
                status.style.background = "var(--error-bg)";
                status.style.color = "var(--error)";
                btn.disabled = false;
                btn.innerText = "Tentar Novamente";
            }
        }

        checkAuth();
    </script>
</body>
</html>